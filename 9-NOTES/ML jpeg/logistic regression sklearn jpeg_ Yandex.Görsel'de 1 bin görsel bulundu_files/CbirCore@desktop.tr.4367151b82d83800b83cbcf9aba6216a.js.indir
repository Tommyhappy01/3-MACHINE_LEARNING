!function(t){function e(e){for(var n,a,c=e[0],u=e[1],l=e[2],f=0,h=[];f<c.length;f++)a=c[f],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&h.push(i[a][0]),i[a]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(t[n]=u[n]);for(s&&s(e);h.length;)h.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],n=!0,c=1;c<r.length;c++){var u=r[c];0!==i[u]&&(n=!1)}n&&(o.splice(e--,1),t=a(a.s=r[0]))}return t}var n={},i={265:0},o=[];function a(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=n,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="https://yastatic.net/s3/fiji-static/_/";var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var s=u;o.push([1769,"b6fdfd"]),r()}({0:function(t,e){t.exports=React},10:function(t,e,r){"use strict";r.d(e,"a",function(){return c}),r.d(e,"b",function(){return u});var n=r(28),i=r(11),o=function(t,e){var r=t.dtype,i=void 0===r?"iweb":r,o=t.path,a=t.vars,c=t.pid,u=t.cid;void 0===e&&(e=!0);var l={dtype:i,path:o,pid:c,cid:u},s=a&&Object(n.e)(a,e);return s&&(l.vars=s),l},a=function(){},c=i.a?function(t,e,r,n){var i,a=void 0===e?{}:e,c=a.reqid,u=a.dtype,l=a.vars,s=a.pid,f=a.cid,h=a.href;void 0===r&&(r=!0);var p=(void 0===n?{}:n).prepareHitParamsCb,d=void 0===p?o:p;null===(i=window.c)||void 0===i||i.hit(d({path:t,reqid:c,dtype:u,vars:l,pid:s,cid:f},r),h?{href:h}:void 0)}:a,u=i.a?function(t,e,r,n){var i,a=void 0===e?{}:e,c=a.reqid,u=a.dtype,l=a.vars,s=a.pid,f=a.cid,h=a.href;void 0===r&&(r=!0);var p=(void 0===n?{}:n).prepareHitParamsCb,d=void 0===p?o:p;null===(i=window.c)||void 0===i||i.hitDelayed(d({path:t,reqid:c,dtype:u,vars:l,pid:s,cid:f},r),h?{href:h}:void 0)}:a},1029:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(t){return t.nodeType!==Node.ELEMENT_NODE?null:"IMG"===t.tagName?t:t.querySelector("img[src]")||t.querySelector("[style*=background-image]")||null}},1186:function(t,e,r){"use strict";r.d(e,"a",function(){return ut});var n=r(0),i=r.n(n),o=r(7),a=r(10),c=r(78),u=r(164),l=Array.prototype.slice,s=function(t){var e=Object(n.useCallback)(function(e){var r=e.clipboardData||window.clipboardData;if(r){var n=function(t){if(t.items){var e=l.call(t.items).find(function(t){return"file"===t.kind});if(e)return e.getAsFile()}return t.files.length>0?t.files[0]:null}(r);n&&(e.preventDefault(),t(n))}},[t]);Object(u.a)("paste",e)},f=r(11);f.a&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,r){void 0===e&&(e="image/png");var n=this.toDataURL(e,r).split(",")[1];setTimeout(function(){for(var r=atob(n),i=r.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=r.charCodeAt(a);t(new Blob([o],{type:e}))})}});var h=r(314),p=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},d=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},b=1,y=3,v=6,w=8,g=9,m=function(t){return 65280===(65280&t)},O=function(){function t(t){this.offset=0,this.littleEndian=!1,this.view=new DataView(t)}return t.prototype.skip=function(t){this.offset+=t},t.prototype.nextUint16=function(){var t=this.view.getUint16(this.offset,this.littleEndian);return this.skip(2),t},t.prototype.nextUint32=function(){var t=this.view.getUint32(this.offset,this.littleEndian);return this.skip(4),t},t.prototype.setLittleEndian=function(t){this.littleEndian=t},t.prototype.isFinished=function(){return this.offset>=this.view.byteLength},t}(),j=function(t){return p(void 0,void 0,Promise,function(){var e,r,n,i,o;return d(this,function(a){switch(a.label){case 0:return function(){return"from-image"===getComputedStyle(document.body).imageOrientation}()?[2,b]:[4,function(t){return new Promise(function(e,r){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=r,n.readAsArrayBuffer(t)})}(t)];case 1:if(e=a.sent(),65496!==(r=new O(e)).nextUint16())return[2,g];for(;!r.isFinished()&&(n=r.nextUint16(),m(n)&&65498!==n&&65497!==n);)if(65505===n)for(r.skip(2),r.skip(6),r.setLittleEndian(18761===r.nextUint16()),r.skip(2),r.skip(r.nextUint32()-8),i=r.nextUint16(),o=0;o<i;o++){if(274===r.nextUint16())return r.skip(6),[2,r.nextUint16()];r.skip(10)}else r.setLittleEndian(!1),r.skip(r.nextUint16()-2);return[2,g]}})})},x=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r},k=function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},S=function(t,e){var r=k(function(t,e){var r=0,n=0,i="none";return e===w?(r=t.height,n=t.width,i="left"):e===v?(r=t.height,n=t.width,i="right"):e===y?(r=t.width,n=t.height,i="flip"):(r=t.width,n=t.height),[{width:r,height:n},i]}(t,e),2),n=r[0],i=r[1],o=function(t){var e=t.width/t.height,r=0,n=0,i={width:0,height:0};return t.width*t.height>5e6?t.width>t.height?(r=Math.sqrt(5e6*e),i={width:Math.floor(r),height:Math.floor(5e6/r)}):(n=Math.sqrt(5e6/e),i={width:Math.floor(5e6/n),height:Math.floor(n)}):i=t,i.width>4096&&(i.width=4096,i.height=Math.round(i.width/e)),i.height>4096&&(i.height=4096,i.width=Math.round(e*i.height)),i}(n),a=x(o.width,o.height),c=a.getContext("2d");if(!c)throw new Error("Cannot get a canvas context");return"left"===i?(c.setTransform(0,-1,1,0,0,o.height),c.drawImage(t,0,0,o.height,o.width)):"right"===i?(c.setTransform(0,1,-1,0,o.width,0),c.drawImage(t,0,0,o.height,o.width)):"flip"===i?(c.setTransform(-1,0,0,-1,o.width,o.height),c.drawImage(t,0,0,o.width,o.height)):(c.setTransform(1,0,0,1,0,0),c.drawImage(t,0,0,o.width,o.height)),a},E=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},C=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},P=function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},T=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},U=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},M=function(t,e,r){return t.width>e&&t.height>r},_=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},I=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},L=function(t,e,r,n,i){return void 0===n&&(n=t.type),void 0===i&&(i=1),_(void 0,void 0,Promise,function(){return I(this,function(o){switch(o.label){case 0:return[4,function(t){return E(void 0,void 0,Promise,function(){var e,r,n;return C(this,function(i){switch(i.label){case 0:return[4,Promise.all([Object(h.b)(t),j(t)])];case 1:return e=P.apply(void 0,[i.sent(),2]),r=e[0],n=e[1],[2,S(r,n)]}})})}(t)];case 1:return[4,function(t,e,r){return T(void 0,void 0,Promise,function(){var n,i,o,a,c;return U(this,function(u){switch(u.label){case 0:return n=t.width/t.height,r<e?r=Math.round(e/n):e=Math.round(r*n),M(t,e,r)?(i=Math.ceil(Math.log(t.width/e)/Math.LN2),o=e*Math.pow(2,i-1),a=r*Math.pow(2,i-1),c=function(n,u){var l=x(o,a),s=l.getContext("2d");return null===s?u(new Error("Cannot get a canvas context")):(s.drawImage(t,0,0,o,a),t.width=1,t.height=1,t=l,i-=1,o=Math.round(o/2),a=Math.round(a/2),i<=0||!M(t,e,r)?n(t):void requestAnimationFrame(function(){return c(n,u)}))},[4,new Promise(c)]):[2,t];case 1:return[2,u.sent()]}})})}(o.sent(),e,r)];case 2:return[4,function(t,e,r){return void 0===r&&(r=1),new Promise(function(n,i){try{t.toBlob(function(t){return t?n(t):i(new Error("Resulting Blob is empty"))},e,r)}catch(t){i(t)}})}(o.sent(),n,i)];case 3:return[2,o.sent()]}})})},D=function(t){return t.replace(/\/preview$/,"/orig")},A=r(30),J=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},R=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},B=function(t){return J(void 0,void 0,Promise,function(){var e,r;return R(this,function(n){switch(n.label){case 0:return e=function(){return Object(A.appendQueryString)("/images-apphost/image-download",{cbird:37,images_avatars_size:"preview",images_avatars_namespace:"images-cbir"})}(),[4,fetch(e,{method:"POST",body:t})];case 1:if((r=n.sent()).status<200||r.status>=300)throw new Error("Image upload failed, status code "+r.status);return[4,r.json()];case 2:return[2,n.sent()]}})})},q=r(48),F=r(134),z=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},G=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},H=function(){var t=Object(F.a)();return Object(n.useCallback)(function(e){var r=e.originalImageUrl,n=e.cbirId;return z(void 0,void 0,void 0,function(){var e;return G(this,function(i){switch(i.label){case 0:return e=function(t){var e=t.originalImageUrl,r=t.cbirId,n={rpt:"imageview",from:void 0};return e&&(n.url=e),r&&(n.cbir_id=r),BEM.blocks["i-global"].param("isYandexApp")&&(n.service="cbir.yandex"),"0"===BEM.blocks.uri.getParamValue("native")&&(n.native="0"),BEM.blocks.uri.buildRelativeUrl(BEM.blocks["i-global"].param("router").search,BEM.blocks["i-url-controller"].mergePassedUrlParams(n))}({originalImageUrl:r,cbirId:n}),[4,t({cbirPageType:"search-by-image",cbirCropRect:void 0,cbirCropId:void 0},void 0,e)];case 1:return i.sent(),Object(o.a)().emit("cbir:load-page",{pageType:"search-by-image",url:e,withHistoryReplace:!0}),[2]}})})},[t])},Y=function(){var t=Object(n.useRef)(),e=Object(n.useCallback)(function(e){var r=e+"_"+Date.now()+"_"+Math.random();return t.current=r,r},[]),r=Object(n.useCallback)(function(e){return t.current===e},[]),i=Object(n.useCallback)(function(){t.current=void 0},[]),o=Object(n.useCallback)(function(e){t.current=e.searchUniqKey},[]);return Object(c.a)("cbir:search-by-image:start",o),Object(c.a)("cbir:search-by-image:success",i),Object(c.a)("cbir:search-by-image:error",i),Object(c.a)("cbir:popup-closed",i),[e,r]},N=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},K=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Q=function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},W=function(t){var e=t.downscaleWidth,r=t.downscaleHeight,i=t.downscaleQuality,u=Q(Y(),2),l=u[0],s=u[1],f=H(),h=Object(n.useCallback)(function(t){return N(void 0,void 0,void 0,function(){var n,c,u,h,p,d,b;return K(this,function(y){switch(y.label){case 0:n=Date.now(),c=l("file"),y.label=1;case 1:return y.trys.push([1,5,,6]),Object(o.a)().emit("cbir:search-by-image:start",{searchType:"file",file:t,searchUniqKey:c}),[4,L(t,e,r,"image/jpeg",i)];case 2:return u=y.sent(),[4,B(u)];case 3:return h=y.sent(),s(c)?function(t){return"type"in t&&"captcha"===t.type}(h)?(function(t){var e=Object(q.a)("project").replace("/",".");Object(a.a)(e,{dtype:"stred",pid:40,cid:72952}),location.assign(t.captcha["captcha-page"])}(h),[2]):(p=D(h.url),d=function(t){return t.image_shard+"/"+t.image_id}(h),[4,f({originalImageUrl:p,cbirId:d})]):[2];case 4:return y.sent(),Object(o.a)().emit("cbir:search-by-image:success",{searchType:"file",file:t,downscaledFile:u,originalImageUrl:p,cbirId:d,time:Date.now()-n,searchUniqKey:c}),[3,6];case 5:return b=y.sent(),Object(o.a)().emit("cbir:search-by-image:error",{searchType:"file",error:b,file:t,time:Date.now()-n,searchUniqKey:c}),[3,6];case 6:return[2]}})})},[e,r,i,l,s,f]);Object(c.a)("cbir:search-by-file",h)},V=/^(?:http|https|ftp):\/\//,$=function(t,e){if(void 0===e&&(e="http:"),V.test(t))return t;var r=f.a?location.protocol:e;return 0===t.indexOf("//")?r+t:r+"//"+t},X=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},Z=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},tt=function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},et=r(1706),rt=r(1029),nt=r(983),it=function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},ot=r(703),at=r(950),ct=Object(n.forwardRef)(function(t,e){var r=t.onSelect,o=Object(ot.a)(e),a=Object(n.useCallback)(function(){var t;if(o.current){var e=null===(t=o.current.files)||void 0===t?void 0:t[0];e&&r(e),o.current.value=""}},[o,r]);return i.a.createElement("input",{ref:o,className:Object(at.a)("FileInput"),type:"file",accept:"image/*",onChange:a,hidden:!0})}),ut=function(t){var e=t.downscaleWidth,r=t.downscaleHeight,u=t.downscaleQuality,l=t.isYandexBroNativeCameraDialog,f=void 0!==l&&l,p=t.isYandexAppAndroid,d=void 0!==p&&p,b=t.isYandexAppIos,y=void 0!==b&&b,v=t.counterPaths,w=Object(n.useRef)(null),g=Object(n.useCallback)(function(t){"file"===t.searchType?Object(a.a)(v.searchByFileStart,{vars:{size:t.file.size,type:t.file.type}}):Object(a.a)(v.searchByUrlStart,{vars:{url:t.url}})},[v]);Object(c.a)("cbir:search-by-image:start",g);var m=Object(n.useCallback)(function(t){"file"===t.searchType?Object(a.a)(v.searchByFileSuccess,{vars:{size:t.file.size,type:t.file.type,time:t.time}}):Object(a.a)(v.searchByUrlSuccess,{vars:{url:t.url,time:t.time}})},[v]);Object(c.a)("cbir:search-by-image:success",m);var O=Object(n.useCallback)(function(t){var e,r=(null===(e=t.error)||void 0===e?void 0:e.message)||t.error;"file"===t.searchType?Object(a.a)(v.searchByFileError,{vars:{size:t.file.size,type:t.file.type,time:t.time,error:"string"===typeof r?r:""}}):Object(a.a)(v.searchByUrlError,{vars:{url:t.url,time:t.time,error:"string"===typeof r?r:""}})},[v]);Object(c.a)("cbir:search-by-image:error",O);var j=Object(n.useCallback)(function(){var t;Object(a.a)(v.fileDialogOpen),f||d?location.assign("native://image_search"):y?location.assign("wireframe://?intent=openImageSearchScreen"):null===(t=w.current)||void 0===t||t.click()},[f,d,y,v]);Object(c.a)("cbir:open-file-dialog",j),W({downscaleWidth:e,downscaleHeight:r,downscaleQuality:u}),function(){var t=tt(Y(),2),e=t[0],r=t[1],i=H(),a=Object(n.useCallback)(function(t){return X(void 0,void 0,void 0,function(){var n,a,c,u;return Z(this,function(l){switch(l.label){case 0:n=$(t),a=Date.now(),c=e("url"),l.label=1;case 1:return l.trys.push([1,4,,5]),Object(o.a)().emit("cbir:search-by-image:start",{searchType:"url",url:n,searchUniqKey:c}),[4,Object(h.a)(n,{referrerPolicy:"no-referrer"})];case 2:return l.sent(),r(c)?[4,i({originalImageUrl:n})]:[2];case 3:return l.sent(),Object(o.a)().emit("cbir:search-by-image:success",{searchType:"url",url:n,time:Date.now()-a,searchUniqKey:c}),[3,5];case 4:return u=l.sent(),Object(o.a)().emit("cbir:search-by-image:error",{searchType:"url",error:u,url:n,time:Date.now()-a,searchUniqKey:c}),[3,5];case 5:return[2]}})})},[e,r,i]);Object(c.a)("cbir:search-by-url",a)}();var x=Object(n.useCallback)(function(t){Object(a.a)(v.clipboardFile,{vars:{size:t.size,type:t.type}}),Object(o.a)().emit("cbir:search-by-file",t)},[v]);s(x),function(t,e){var r=Object(n.useRef)(!1),i=Object(n.useRef)(!1),o=Object(n.useRef)(0),a=it(Object(et.a)(),2),u=a[0],l=a[1],s=l.add,f=l.remove;Object(c.a)("cbir:register-global-drop-area",s),Object(c.a)("cbir:unregister-global-drop-area",f);var h=Object(n.useCallback)(function(){window.clearTimeout(o.current),o.current=0},[]),p=Object(n.useCallback)(function(e){r.current||(h(),r.current=!0,i.current=e,requestAnimationFrame(function(){return t(e)}))},[h,t]),d=Object(n.useCallback)(function(){if(r.current){h();var t=i.current;r.current=!1,i.current=!1,o.current=window.setTimeout(e,50,t)}},[h,e]);Object(n.useEffect)(function(){return u.forEach(function(t){t.addEventListener("drop",d),t.addEventListener("dragleave",d)}),function(){u.forEach(function(t){t.removeEventListener("drop",d),t.removeEventListener("dragleave",d)})}},[u,d]),Object(n.useEffect)(function(){var t=function(t){var e=t.dataTransfer;if(t.target&&e){var r=Object(rt.a)(t.target);if(r){r!==t.target&&"function"===typeof e.setDragImage&&e.setDragImage(r,0,0);var n=Object(nt.a)(r);n&&function(t,e){try{t.setData("text/uri-list",e),t.setData("text/plain",e)}catch(r){t.setData("URL",e),t.setData("Text",e)}}(e,$(n))}}p(!1)},e=function(){return p(!0)},r=function(){return d()};return document.addEventListener("dragstart",t),document.addEventListener("dragover",e),document.addEventListener("dragend",r),function(){document.removeEventListener("dragstart",t),document.removeEventListener("dragover",e),document.removeEventListener("dragend",r)}},[p,d])}(Object(n.useCallback)(function(t){Object(a.a)(v.dragStart),Object(o.a)().emit("cbir:drag-start",t)},[v]),Object(n.useCallback)(function(t){Object(a.a)(v.dragEnd),Object(o.a)().emit("cbir:drag-end",t)},[v]));var k=Object(n.useCallback)(function(t){Object(a.a)(v.fileDialogSelect,{vars:{size:t.size,type:t.type}}),Object(o.a)().emit("cbir:search-by-file",t)},[v]);return i.a.createElement(ct,{ref:w,onSelect:k})}},134:function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(0),i=r(43),o=r(51),a=function(){return Object(n.useCallback)(function(t,e,r){return void 0===e&&(e=document.title),void 0===r&&(r=location.href),Object(o.a)().pushJob(function(){return history.pushState(Object(i.d)(t),e,r)},!1)},[])}},135:function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(43),i=function(){function t(){this.listeners=[],this.jobs=[],this.onPopState=this.onPopState.bind(this)}return t.prototype.resolveCurrentJob=function(t,e){this.listeners.forEach(function(e){return e(t)}),this.currentJob&&this.currentJob.async===e?(this.currentJob.resolve(t),this.currentJob=void 0):this.reset()},t.prototype.executeCurrentJob=function(){var t=this;this.currentJob&&(this.currentJob.execute(),this.currentJob.async||(this.nextTickJobTimeoutId=window.setTimeout(function(){t.resolveCurrentJob(Object(n.c)(),!1),t.next()})))},t.prototype.onPopState=function(t){this.resolveCurrentJob(t.state||{},!0),this.next()},t.prototype.next=function(){this.currentJob||(this.currentJob=this.jobs.shift(),this.executeCurrentJob())},t.prototype.reset=function(){this.jobs=[],this.currentJob=void 0,window.clearTimeout(this.nextTickJobTimeoutId)},t.prototype.startListening=function(t){0===this.listeners.length&&window.addEventListener("popstate",this.onPopState),this.listeners.push(t)},t.prototype.stopListening=function(t){this.listeners=this.listeners.filter(function(e){return e!==t}),0===this.listeners.length&&window.removeEventListener("popstate",this.onPopState)},t.prototype.pushJob=function(t,e){var r=this;return new Promise(function(n){r.jobs.push({execute:t,resolve:n,async:e}),r.next()})},t}()},14:function(t,e){t.exports=ReactDOM},1769:function(t,e,r){r(83),t.exports=r(2137)},2137:function(t,e,r){"use strict";r.r(e),r.d(e,"App",function(){return a});var n=r(25),i=r(1186).a,o=r(950),a=Object(n.b)(o.b)(i)},28:function(t,e,r){"use strict";r.d(e,"e",function(){return o}),r.d(e,"a",function(){return a}),r.d(e,"b",function(){return c}),r.d(e,"c",function(){return u}),r.d(e,"d",function(){return l});var n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a};function o(t,e){if("string"===typeof t||!t)return t||"";if(Array.isArray(t))return t.join(",");var r=e?"-":"";return Object.keys(t).filter(function(e){return void 0!==t[e]&&""!==t[e]}).map(function(e){return""+(r&&0===e.indexOf(r)?"":r)+e+"="+t[e]}).join(",")}function a(t){if(t)return t.logNode}function c(t,e,r,i){void 0===e&&(e={}),void 0===r&&(r={}),void 0===i&&(i={href:""});var a=u(t);if(!a||!a.__oldCounter__)return a;var c=a.__oldCounter__,s=o(n(n({},l(c.vars||{})),l(e)),!0);return n(n({},a),{__oldCounter__:n(n(n({},c),{vars:s}),r),node:i})}function u(t){if(t&&Array.isArray(t.counter)){var e=i(t.counter,2),r=e[0],n=e[1];return{__oldCounter__:{path:r||"",vars:n||""}}}return t||{}}function l(t){return void 0===t&&(t={}),"object"===typeof t?t:t.split(",").reduce(function(t,e){var r=e.split("=");return t[r[0]]=r[1],t},{})}},314:function(t,e,r){"use strict";r.d(e,"a",function(){return a}),r.d(e,"b",function(){return c});var n=r(63),i=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function c(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,c)}u((n=n.apply(t,e||[])).next())})},o=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},a=function(t,e){var r=void 0===e?{}:e,i=r.crossOrigin,o=r.referrerPolicy;return new Promise(function(e,r){var a=new Image;Object(n.a)(a,"crossOrigin",i),Object(n.a)(a,"referrerPolicy",o),Object(n.a)(a,"onload",function(){return e(a)}),Object(n.a)(a,"onerror",function(){return r(new Error("Image loading failed"))}),Object(n.a)(a,"src",t)})},c=function(t){return i(void 0,void 0,Promise,function(){var e,r,n,i;return o(this,function(o){switch(o.label){case 0:e=window.URL||window.webkitURL,r=e.createObjectURL(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a(r)];case 2:return n=o.sent(),e.revokeObjectURL(r),[2,n];case 3:throw i=o.sent(),e.revokeObjectURL(r),i;case 4:return[2]}})})}},39:function(t,e,r){"use strict";var n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,a={},c=0,u=0;function l(t){var e="";do{e=i[t%o]+e,t=Math.floor(t/o)}while(t>0);return e}function s(){var t=l(+new Date);return t!==n?(c=0,n=t):t+"."+l(c++)}for(;u<o;u++)a[i[u]]=u;s.encode=l,s.decode=function(t){var e=0;for(u=0;u<t.length;u++)e=e*o+a[t.charAt(u)];return e},t.exports=s},43:function(t,e,r){"use strict";r.d(e,"c",function(){return o}),r.d(e,"d",function(){return a}),r.d(e,"b",function(){return c}),r.d(e,"a",function(){return u});var n=r(11),i=Object.prototype.hasOwnProperty,o=function(){return Object.assign({},n.a?history.state:null)},a=function(t){return Object.assign({},o(),t)},c=function(t){return void 0===t&&(t={}),Object.assign({},"function"===typeof t?t():t)},u=function(t,e){var r=Object.assign({},t);for(var n in e)i.call(e,n)&&!i.call(r,n)&&(r[n]=e[n]);return r}},48:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(t){return function(){return window.Ya.SerpContext}()[t]}},51:function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(135),i=function(){return window.Ya=window.Ya||{},window.Ya.HistoryQueue||(window.Ya.HistoryQueue=new n.a),window.Ya.HistoryQueue}},59:function(t,e,r){"use strict";"function"===typeof Element&&(Element.prototype.matches=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector)},63:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(t,e,r){void 0!==r&&(t[e]=r)}},83:function(t,e,r){r.r(e);var n=r(5);Object(n.setI18nLang)("tr")},84:function(t,e,r){"use strict";t.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(e)){if((n=e.length)!=r.length)return!1;for(i=n;0!==i--;)if(!t(e[i],r[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if((n=(o=Object.keys(e)).length)!==Object.keys(r).length)return!1;for(i=n;0!==i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!==i--;){var a=o[i];if(("_owner"!==a||!e.$$typeof)&&!t(e[a],r[a]))return!1}return!0}return e!==e&&r!==r}},950:function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"a",function(){return o});var n=r(3),i="CbirCore",o=Object(n.cn)("CbirCore")},983:function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=r(984),i=function(t){return"IMG"===t.tagName?t.getAttribute("src"):Object(n.a)(t)}},984:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(t){var e=getComputedStyle(t).backgroundImage.match(/url\("([^"]+)"\)/);return e?e[1]:null}}});