-- write your code in PostgreSQL 9.4
SELECT DISTINCT plays.id, title, COALESCE(SUM(number_of_tickets), 0) AS reserved_tickets
FROM plays LEFT JOIN reservations
ON plays.id = reservations.play_id
GROUP BY plays.id, title
ORDER BY reserved_tickets DESC


-- 2. way
create database a;
use a;
create table plays (
    id integer not null,
    title varchar(40) not null,
    writer varchar(40) not null,
    unique(id)
);
create table reservations (
    id integer not null,
    play_id integer not null,
    number_of_tickets integer not null,
    theater varchar(40) not null,
    unique(id)
);
insert into plays (id, title, writer) values (109, 'Queen', 'AAAA');
insert into plays (id, title, writer) values (123, 'Merlin', 'BBBB');
insert into plays (id, title, writer) values (142, 'Key', 'CCCC');
insert into plays (id, title, writer) values (144, 'ROME', 'DDDD');
insert into plays (id, title, writer) values (145, 'Namel', 'EEEE');

-- select * from plays;

insert into reservations (id, play_id, number_of_tickets, theater) values (13, 109, 12, 'AA');
insert into reservations (id, play_id, number_of_tickets, theater) values (24, 109, 34, 'AA');
insert into reservations (id, play_id, number_of_tickets, theater) values (37, 145, 84, 'AA');
insert into reservations (id, play_id, number_of_tickets, theater) values (49, 145, 45, 'AA');
insert into reservations (id, play_id, number_of_tickets, theater) values (51, 145, 41, 'AA');
insert into reservations (id, play_id, number_of_tickets, theater) values (68, 123, 3, 'AA');
insert into reservations (id, play_id, number_of_tickets, theater) values (83, 142, 46, 'AA');

-- select * from reservations;
SELECT DISTINCT plays.id, title, IFNULL(SUM(number_of_tickets), 0) AS reserved_tickets
FROM plays LEFT JOIN reservations
ON plays.id = reservations.play_id
GROUP BY plays.id
ORDER BY reserved_tickets DESC; 

-- NOT: IFNULL or ISNULL or COALESCE : up to your SQL type
